<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; gap: 1rem;">
  <h1 class="fw-bold" style="font-size: 3.19rem; margin: 0; font-family: 'Inter', 'Segoe UI', sans-serif; font-weight: 700;">Lista de Tarefas Coletiva</h1>

  <div style="display: flex; align-items: center; gap: 1rem;">
    <select class="form-select" style="min-width: 150px; font-size: 1.155rem; padding: 0.63rem 1.05rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border-color: #ccc;" name="usuarioSelecionadoFiltro" (change)="selecionarUsuarioFiltro($event)">
      <option value="">Listar</option>
      <option *ngFor="let usr of usuarios; trackBy: rastrearUsuarioPorId" [value]="usr.id">{{ usr.nome }}</option>
    </select>
  </div>
</div>

<form class="d-flex gap-2 mb-4" (ngSubmit)="adicionarTarefa()" style="gap: 0.231rem; flex-wrap: wrap;">
  <input
    type="text"
    class="form-control"
    placeholder="Adicionar tarefa"
    name="novaTarefaTexto"
    [(ngModel)]="novaTarefaTexto"
    (keyup.enter)="adicionarTarefa()"
    required
    style="flex: 1; min-width: 200px; font-size: 1.155rem; padding: 0.63rem 1.05rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border-color: #ccc;"
  >
  <select class="form-select" style="max-width: 173.25px; font-size: 1.155rem; padding: 0.63rem 1.05rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border-color: #ccc;" name="usuarioSelecionadoAdicionarTarefa" [(ngModel)]="usuarioSelecionadoAdicionarTarefa">
    <option [value]="null" disabled selected>UsuÃ¡rio</option>
    <option *ngFor="let usr of usuarios; trackBy: rastrearUsuarioPorId" [value]="usr.id">{{ usr.nome }}</option>
  </select>
  <select class="form-select" style="max-width: 173.25px; font-size: 1.155rem; padding: 0.63rem 1.05rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border-color: #ccc;" name="categoriaSelecionadaAdicionarTarefa" [(ngModel)]="categoriaSelecionadaAdicionarTarefa">
    <option disabled [value]="null">Categoria</option>
    <option *ngFor="let cat of categorias">{{ cat }}</option>
  </select>
  <button class="btn btn-outline-secondary" type="button" (click)="abrirModalAdicionarUsuario()" title="Adicionar novo usuÃ¡rio" style="font-size: 1.155rem; padding: 0.63rem 1.575rem; border-color: #ccc; color: #333; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: all 0.2s ease;">+ UsuÃ¡rio</button>
  <button class="btn btn-outline-secondary" type="button" (click)="abrirModalAdicionarCategoria()" title="Adicionar nova categoria" style="font-size: 1.155rem; padding: 0.63rem 1.575rem; border-color: #ccc; color: #333; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: all 0.2s ease;">+ Categoria</button>
</form>

<small style="display: block; color: #9370DB; font-size: 0.85rem; font-weight: 500; margin-bottom: 1.5rem;">
  Aperte enter pra adicionar
</small>

<div class="d-flex flex-column align-items-center justify-content-center" style="height: 50vh; padding-top: 4rem;" *ngIf="tarefasFiltradas.length === 0">
  <img src="sem-tarefa.png" alt="sem tarefas" class="mb-3" style="width: 200px; filter: brightness(1.2) drop-shadow(0 4px 12px rgba(147, 112, 219, 0.5));">
  <div class="text-muted fs-5" style="font-size: 1.21rem;">Nenhuma tarefa adicionada ğŸ¥²</div>
</div>

<div *ngIf="tarefasFiltradas.length > 0" cdkDropList (cdkDropListDropped)="aoSoltarTarefa($event)" class="lista-tarefas">
  <div *ngFor="let tarefa of tarefasFiltradas" class="mb-3" cdkDrag>
    <app-item-tarefa 
      [tarefa]="tarefa" 
      (aoRemover)="removerTarefa($event)" 
      (aoAtualizar)="atualizarTarefa($event)"
      (aoEditarCategorias)="abrirModalEditarCategorias($event)">
    </app-item-tarefa>
  </div>
</div>

<app-modal-categorias 
  *ngIf="mostrarModalEditarCategorias && tarefaSelecionadaParaEditarCategorias"
  [tarefa]="tarefaSelecionadaParaEditarCategorias"
  (aoSalvar)="salvarCategoriasDaTarefa($event)"
  (aoFechar)="fecharModalEditarCategorias()">
</app-modal-categorias>

<app-modal-usuario
  *ngIf="mostrarModalAdicionarUsuario"
  (aoFechar)="fecharModalAdicionarUsuario()">
</app-modal-usuario>

<app-modal-adicionar-categoria
  *ngIf="mostrarModalAdicionarCategoria"
  (aoAdicionarCategoria)="adicionarNovaCategoria($event)"
  (aoFechar)="fecharModalAdicionarCategoria()">
</app-modal-adicionar-categoria>