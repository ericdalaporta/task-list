<div class="p-3 border rounded task-card" [ngClass]="{'completed-task': tarefa.completa}" cdkDragHandle style="cursor: grab;">
  <div class="task-main-row">
    <div class="task-header">
      <div class="form-check">
        <input 
          class="form-check-input" 
          type="checkbox" 
          [checked]="tarefa.completa"
          (change)="toggleCompleto()"
          [id]="'check-' + tarefa.id"
        >
        <label class="form-check-label" [for]="'check-' + tarefa.id"></label>
      </div>

      <div>
        <div *ngIf="!isEditing" [ngClass]="{'completed-title': tarefa.completa}">
          <h5 class="task-title">{{ tarefa.titulo }}</h5>
        </div>

        <div *ngIf="isEditing">
          <div class="edit-row">
            <input 
              type="text" 
              class="form-control form-control-sm" 
              [(ngModel)]="editingTitle"
              (keyup.enter)="saveEdit()"
              (keyup.escape)="cancelEdit()"
            >
            <button class="btn btn-sm btn-success" (click)="saveEdit()">Salvar</button>
            <button class="btn btn-sm btn-secondary" (click)="cancelEdit()">Cancelar</button>
          </div>
        </div>
      </div>
    </div>

    <div class="task-actions">
      <i class="bi bi-pen action-icon" (click)="startEdit()" title="Editar tarefa"></i>
      <i class="bi bi-tag action-icon" (click)="abrirModalCategorias()" title="Gerenciar categorias"></i>
      <i class="bi bi-trash action-icon" (click)="remover()" title="Deletar tarefa"></i>
    </div>
  </div>

  <div class="badges-container">
    <span *ngFor="let cat of tarefa.categorias"
          class="badge rounded-pill text-white"
          [ngClass]="getBadgeClass(cat)">
      {{ cat }}
    </span>
  </div>
</div>
